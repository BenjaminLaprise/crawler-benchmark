{% extends "layout/layout.html" %}
{% block body %}
    {% if error %}<p class=error><strong>Error:</strong> {{ error }}{% endif %}

    {% if not session.logged_in %}
        {% include "layout/login.html" %}
    {% else %}

        <h2>Speed by user agents</h2>

        <img src="{{ url_for('plot') }}" id="imgResult" alt="Image Placeholder"/>

        <div id="divUserAgent">
            <form id="frmUserAgent" class="pure-form pure-form-aligned" action="{{ url_for('plot') }}">
                <fieldset>
                    <legend>Manage graph</legend>
                    <label for="selUserAgent">User Agents</label>

                    <div>
                        <small>You may select multiple at the same time</small>
                    </div>
                    <br>
                    <select name="selUserAgent" id="selUserAgent" class="full-width" data-url="{{ url_for('get_user_agents') }}" multiple>
                        {% for user_agent in user_agents %}
                            <option value="{{ user_agent }}">{{ user_agent }}</option>
                        {% endfor %}
                    </select>

                    <input type="submit" class="pure-button pure-button-green" value="Update graph">
                    <button id="clearLogUserAgents" class="pure-button pure-button-red"
                            data-url="{{ url_for('clear_log_user_agents') }}">Clear log by user agents
                    </button>
                </fieldset>
            </form>
        </div>

        <h2>Successes</h2>

        <table>
            <tr>
              <th>User Agent</th>
              <th>Challenge</th>
              <th>Moment</th>
            </tr>
            {% for success in successes %}
                <tr>
                  <td>{{ success['user_agent'] }}</td>
                  <td>{{ success['path'].replace('/success/', '') }}</td>
                  <td>{{ success['datetime'] }}</td>
                </tr>
            {% endfor %}
        </table>

        {% import "components/metanav.html" as metanav %}
        {{ metanav.metanav() }}

    {% endif %}
{% endblock %}
